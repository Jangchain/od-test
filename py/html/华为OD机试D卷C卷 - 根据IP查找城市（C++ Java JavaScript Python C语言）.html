
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Document</title>
</head>
<body>
<div id="content_views" class="markdown_views prism-atom-one-light">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <h2><a id="_2"></a>题目描述</h2> 
<p>某业务需要根据终端的IP地址获取该终端归属的城市，可以根据公开的IP地址池信息查询归属城市。</p> 
<p>地址池格式如下：</p> 
<pre><code class="prism language-c">城市名<span class="token operator">=</span>起始IP<span class="token punctuation">,</span>结束IP
</code></pre> 
<p>起始和结束地址按照英文逗号分隔，多个地址段采用英文分号分隔。比如：</p> 
<pre><code class="prism language-c">City1<span class="token operator">=</span><span class="token number">1.1</span><span class="token number">.1</span><span class="token number">.1</span><span class="token punctuation">,</span><span class="token number">1.1</span><span class="token number">.1</span><span class="token number">.2</span><span class="token punctuation">;</span>City1<span class="token operator">=</span><span class="token number">1.1</span><span class="token number">.1</span><span class="token number">.11</span><span class="token punctuation">,</span><span class="token number">1.1</span><span class="token number">.1</span><span class="token number">.16</span><span class="token punctuation">;</span>City2<span class="token operator">=</span><span class="token number">3.3</span><span class="token number">.3</span><span class="token number">.3</span><span class="token punctuation">,</span><span class="token number">4.4</span><span class="token number">.4</span><span class="token number">.4</span><span class="token punctuation">;</span>City3<span class="token operator">=</span><span class="token number">2.2</span><span class="token number">.2</span><span class="token number">.2</span><span class="token punctuation">,</span><span class="token number">6.6</span><span class="token number">.6</span><span class="token number">.6</span>
</code></pre> 
<p>一个城市可以有多个IP段，比如City1有2个IP段。</p> 
<p>城市间也可能存在包含关系，如City3的IP段包含City2的IP段范围。</p> 
<p>现在要根据输入的IP列表，返回最佳匹配的城市列表。</p> 
<p>注：最佳匹配即包含待查询IP且长度最小的IP段，比如例子中3.4.4.4最佳匹配是City2=3.3.3.3,4.4.4.4，5.5.5.5的最佳匹配是City3=2.2.2.2,6.6.6.6</p> 
<h2><a id="_28"></a>输入描述</h2> 
<p>输入共2行。</p> 
<p>第一行为城市的IP段列表，多个IP段采用英文分号 ‘;’ 分隔，IP段列表最大不超过500000。城市名称只包含英文字母、数字和下划线。最多不超过100000个。IP段包含关系可能有多层，但不超过100层。</p> 
<p>第二行为查询的IP列表，多个IP采用英文逗号 ‘,’ 分隔，最多不超过10000条。</p> 
<h2><a id="_37"></a>输出描述</h2> 
<p>最佳匹配的城市名列表，采用英文逗号 ‘,’ 分隔，城市列表长度应该跟查询的IP列表长度一致。</p> 
<p><strong>备注</strong></p> 
<ul><li>无论是否查到匹配正常都要输出分隔符。举例：假如输入IP列表为IPa,IPb，两个IP均未有匹配城市，此时输出为","，即只有一个逗号分隔符，两个城市均为空；</li><li>可以假定用例中的所有输入均合法，IP地址均为合法的ipv4地址，满足 (1<sub>255).(0</sub>255).(0<sub>255).(0</sub>255) 的格式，且可以假定用例中不会出现组播和广播地址；</li></ul> 
<h2><a id="_49"></a>解题思路</h2> 
<ol><li>解析输入的IP地址池字符串，将其转换为每个城市对应的IP范围列表的映射。</li><li>解析输入的查询IP字符串，将其分割成单独的IP地址。</li><li>对于每个查询IP地址，将其转换为长整型数值以便比较。</li><li>遍历每个城市的IP范围列表，检查查询IP是否落在某个范围内。</li><li>如果查询IP落在某个范围内，计算该范围的大小，并与当前已知的最小范围进行比较。</li><li>如果当前范围更小，更新最佳匹配城市和最小范围。</li><li>将最佳匹配城市添加到结果字符串中。</li></ol> 
<p>将IP地址转换成长整型数值（通常是64位的整数）是为了方便比较和计算。IP地址通常以点分十进制格式呈现，如 <code>192.168.1.1</code>，这种格式不便于直接进行数学运算或比较。转换成长整型数值后，IP地址就变成了一个数值，可以轻松地进行比较和范围检查。</p> 
<p>例如，对于IP地址 <code>192.168.1.1</code>：</p> 
<ul><li>将每个十进制块转换为二进制形式：<code>11000000.10101000.00000001.00000001</code></li><li>将这些二进制块拼接成一个32位的二进制数：<code>11000000101010000000000100000001</code></li><li>将这个二进制数转换为长整型数值：<code>3232235777</code></li></ul> 
<p>这样，IP地址就可以像普通的整数一样参与计算和比较操作，使得IP范围匹配变得简单高效。</p> 
<h2><a id="C_70"></a>C++</h2> 
<pre><code class="prism language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;sstream&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;vector&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;map&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;string&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;climits&gt;</span></span>
using namespace std<span class="token punctuation">;</span>

<span class="token comment">// IP范围结构体</span>
<span class="token keyword">struct</span> <span class="token class-name">IpRange</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">long</span> start<span class="token punctuation">;</span> <span class="token comment">// 起始IP的长整型数</span>
    <span class="token keyword">long</span> end<span class="token punctuation">;</span>   <span class="token comment">// 结束IP的长整型数</span>

    <span class="token comment">// 构造函数</span>
    <span class="token function">IpRange</span><span class="token punctuation">(</span><span class="token keyword">long</span> s<span class="token punctuation">,</span> <span class="token keyword">long</span> e<span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token function">start</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">end</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span><span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">// 将字符串形式的IP地址转换为长整型数</span>
<span class="token keyword">long</span> <span class="token function">ipToLong</span><span class="token punctuation">(</span><span class="token keyword">const</span> string<span class="token operator">&amp;</span> ip<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">long</span> result <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    istringstream <span class="token function">ss</span><span class="token punctuation">(</span>ip<span class="token punctuation">)</span><span class="token punctuation">;</span>
    string block<span class="token punctuation">;</span>

    <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token function">getline</span><span class="token punctuation">(</span>ss<span class="token punctuation">,</span> block<span class="token punctuation">,</span> <span class="token char">'.'</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        result <span class="token operator">=</span> <span class="token punctuation">(</span>result <span class="token operator">&lt;&lt;</span> <span class="token number">8</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token function">stoi</span><span class="token punctuation">(</span>block<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">return</span> result<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">// 解析IP地址池字符串，返回城市名到IP范围列表的映射</span>
map<span class="token operator">&lt;</span>string<span class="token punctuation">,</span> vector<span class="token operator">&lt;</span>IpRange<span class="token operator">&gt;&gt;</span> <span class="token function">parseIpPool</span><span class="token punctuation">(</span><span class="token keyword">const</span> string<span class="token operator">&amp;</span> ipPool<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    map<span class="token operator">&lt;</span>string<span class="token punctuation">,</span> vector<span class="token operator">&lt;</span>IpRange<span class="token operator">&gt;&gt;</span> cityIpRanges<span class="token punctuation">;</span>
    istringstream <span class="token function">ss</span><span class="token punctuation">(</span>ipPool<span class="token punctuation">)</span><span class="token punctuation">;</span>
    string cityRange<span class="token punctuation">;</span>

    <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token function">getline</span><span class="token punctuation">(</span>ss<span class="token punctuation">,</span> cityRange<span class="token punctuation">,</span> <span class="token char">';'</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">auto</span> pos <span class="token operator">=</span> cityRange<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token char">'='</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        string city <span class="token operator">=</span> cityRange<span class="token punctuation">.</span><span class="token function">substr</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> pos<span class="token punctuation">)</span><span class="token punctuation">;</span>
        string ranges <span class="token operator">=</span> cityRange<span class="token punctuation">.</span><span class="token function">substr</span><span class="token punctuation">(</span>pos <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">auto</span> rangePos <span class="token operator">=</span> ranges<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token char">','</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">long</span> start <span class="token operator">=</span> <span class="token function">ipToLong</span><span class="token punctuation">(</span>ranges<span class="token punctuation">.</span><span class="token function">substr</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> rangePos<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">long</span> end <span class="token operator">=</span> <span class="token function">ipToLong</span><span class="token punctuation">(</span>ranges<span class="token punctuation">.</span><span class="token function">substr</span><span class="token punctuation">(</span>rangePos <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        cityIpRanges<span class="token punctuation">[</span>city<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">emplace_back</span><span class="token punctuation">(</span>start<span class="token punctuation">,</span> end<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">return</span> cityIpRanges<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">// 根据IP地址池和查询IP列表，返回最佳匹配城市列表的字符串</span>
string <span class="token function">matchCities</span><span class="token punctuation">(</span><span class="token keyword">const</span> string<span class="token operator">&amp;</span> ipPool<span class="token punctuation">,</span> <span class="token keyword">const</span> string<span class="token operator">&amp;</span> queryIPs<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">auto</span> cityIpRanges <span class="token operator">=</span> <span class="token function">parseIpPool</span><span class="token punctuation">(</span>ipPool<span class="token punctuation">)</span><span class="token punctuation">;</span>
    istringstream <span class="token function">ss</span><span class="token punctuation">(</span>queryIPs<span class="token punctuation">)</span><span class="token punctuation">;</span>
    string ip<span class="token punctuation">;</span>
    string result<span class="token punctuation">;</span>

    <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token function">getline</span><span class="token punctuation">(</span>ss<span class="token punctuation">,</span> ip<span class="token punctuation">,</span> <span class="token char">','</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">long</span> ipNum <span class="token operator">=</span> <span class="token function">ipToLong</span><span class="token punctuation">(</span>ip<span class="token punctuation">)</span><span class="token punctuation">;</span>
        string bestMatchCity<span class="token punctuation">;</span>
        <span class="token keyword">long</span> smallestRange <span class="token operator">=</span> LONG_MAX<span class="token punctuation">;</span>

        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">auto</span><span class="token operator">&amp;</span> entry <span class="token operator">:</span> cityIpRanges<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">auto</span><span class="token operator">&amp;</span> range <span class="token operator">:</span> entry<span class="token punctuation">.</span>second<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span>ipNum <span class="token operator">&gt;=</span> range<span class="token punctuation">.</span>start <span class="token operator">&amp;&amp;</span> ipNum <span class="token operator">&lt;=</span> range<span class="token punctuation">.</span>end<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                    <span class="token keyword">long</span> rangeSize <span class="token operator">=</span> range<span class="token punctuation">.</span>end <span class="token operator">-</span> range<span class="token punctuation">.</span>start<span class="token punctuation">;</span>
                    <span class="token keyword">if</span> <span class="token punctuation">(</span>rangeSize <span class="token operator">&lt;</span> smallestRange<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                        bestMatchCity <span class="token operator">=</span> entry<span class="token punctuation">.</span>first<span class="token punctuation">;</span>
                        smallestRange <span class="token operator">=</span> rangeSize<span class="token punctuation">;</span>
                    <span class="token punctuation">}</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>

        result <span class="token operator">+=</span> bestMatchCity <span class="token operator">+</span> <span class="token string">","</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>result<span class="token punctuation">.</span><span class="token function">empty</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        result<span class="token punctuation">.</span><span class="token function">pop_back</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 删除最后一个逗号</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">return</span> result<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    string ipPool<span class="token punctuation">,</span> queryIPs<span class="token punctuation">;</span>

    <span class="token comment">// 读取IP地址池和查询IP列表</span>
    <span class="token function">getline</span><span class="token punctuation">(</span>cin<span class="token punctuation">,</span> ipPool<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">getline</span><span class="token punctuation">(</span>cin<span class="token punctuation">,</span> queryIPs<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// 输出匹配的城市列表</span>
    cout <span class="token operator">&lt;&lt;</span> <span class="token function">matchCities</span><span class="token punctuation">(</span>ipPool<span class="token punctuation">,</span> queryIPs<span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>

    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<h2><a id="Java_172"></a>Java</h2> 
<pre><code class="prism language-java"><span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token operator">*</span></span><span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Main</span> <span class="token punctuation">{<!-- --></span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token class-name">Scanner</span> scanner <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Scanner</span><span class="token punctuation">(</span><span class="token class-name">System</span><span class="token punctuation">.</span>in<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">String</span> ipPool <span class="token operator">=</span> scanner<span class="token punctuation">.</span><span class="token function">nextLine</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 读取IP地址池</span>
        <span class="token class-name">String</span> queryIPs <span class="token operator">=</span> scanner<span class="token punctuation">.</span><span class="token function">nextLine</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 读取查询IP列表</span>
 
        <span class="token comment">// 输出匹配的城市列表</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token function">matchCities</span><span class="token punctuation">(</span>ipPool<span class="token punctuation">,</span> queryIPs<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// 匹配城市的方法</span>
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token class-name">String</span> <span class="token function">matchCities</span><span class="token punctuation">(</span><span class="token class-name">String</span> ipPool<span class="token punctuation">,</span> <span class="token class-name">String</span> queryIPs<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token comment">// 解析IP地址池，将其转换为城市与IP范围列表的映射</span>
        <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">List</span><span class="token punctuation">&lt;</span><span class="token class-name">IpRange</span><span class="token punctuation">&gt;</span><span class="token punctuation">&gt;</span></span> cityIpRanges <span class="token operator">=</span> <span class="token function">parseIpPool</span><span class="token punctuation">(</span>ipPool<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// 将查询IP列表按逗号分隔</span>
        <span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> ipsToQuery <span class="token operator">=</span> queryIPs<span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">","</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">StringBuilder</span> result <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">StringBuilder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 用于构建结果字符串</span>

        <span class="token comment">// 遍历每个查询IP</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">String</span> ip <span class="token operator">:</span> ipsToQuery<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">long</span> ipNum <span class="token operator">=</span> <span class="token function">ipToLong</span><span class="token punctuation">(</span>ip<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 将IP地址转换为长整型数</span>
            <span class="token class-name">String</span> bestMatchCity <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">;</span> <span class="token comment">// 最佳匹配城市</span>
            <span class="token keyword">long</span> smallestRange <span class="token operator">=</span> <span class="token class-name">Long</span><span class="token punctuation">.</span><span class="token constant">MAX_VALUE</span><span class="token punctuation">;</span> <span class="token comment">// 最小的IP范围</span>

            <span class="token comment">// 遍历每个城市的IP范围</span>
            <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">Map<span class="token punctuation">.</span>Entry</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">List</span><span class="token punctuation">&lt;</span><span class="token class-name">IpRange</span><span class="token punctuation">&gt;</span><span class="token punctuation">&gt;</span></span> entry <span class="token operator">:</span> cityIpRanges<span class="token punctuation">.</span><span class="token function">entrySet</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">IpRange</span> range <span class="token operator">:</span> entry<span class="token punctuation">.</span><span class="token function">getValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                    <span class="token comment">// 如果IP在当前范围内</span>
                    <span class="token keyword">if</span> <span class="token punctuation">(</span>ipNum <span class="token operator">&gt;=</span> range<span class="token punctuation">.</span>start <span class="token operator">&amp;&amp;</span> ipNum <span class="token operator">&lt;=</span> range<span class="token punctuation">.</span>end<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                        <span class="token keyword">long</span> rangeSize <span class="token operator">=</span> range<span class="token punctuation">.</span>end <span class="token operator">-</span> range<span class="token punctuation">.</span>start<span class="token punctuation">;</span> <span class="token comment">// 计算当前IP范围的大小</span>
                        <span class="token comment">// 如果当前范围更小，则更新最佳匹配城市和最小范围</span>
                        <span class="token keyword">if</span> <span class="token punctuation">(</span>rangeSize <span class="token operator">&lt;</span> smallestRange<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                            bestMatchCity <span class="token operator">=</span> entry<span class="token punctuation">.</span><span class="token function">getKey</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                            smallestRange <span class="token operator">=</span> rangeSize<span class="token punctuation">;</span>
                        <span class="token punctuation">}</span>
                    <span class="token punctuation">}</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>

            <span class="token comment">// 将最佳匹配城市添加到结果中</span>
            result<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span>bestMatchCity<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token string">","</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token comment">// 返回结果字符串，去除最后一个逗号</span>
        <span class="token keyword">return</span> result<span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token number">0</span> <span class="token operator">?</span> result<span class="token punctuation">.</span><span class="token function">substring</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> result<span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">:</span> result<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// 解析IP地址池的方法</span>
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">List</span><span class="token punctuation">&lt;</span><span class="token class-name">IpRange</span><span class="token punctuation">&gt;</span><span class="token punctuation">&gt;</span></span> <span class="token function">parseIpPool</span><span class="token punctuation">(</span><span class="token class-name">String</span> ipPool<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">List</span><span class="token punctuation">&lt;</span><span class="token class-name">IpRange</span><span class="token punctuation">&gt;</span><span class="token punctuation">&gt;</span></span> cityIpRanges <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HashMap</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> cityRanges <span class="token operator">=</span> ipPool<span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">";"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 按分号分隔城市IP范围</span>

        <span class="token comment">// 遍历每个城市的IP范围</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">String</span> cityRange <span class="token operator">:</span> cityRanges<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> parts <span class="token operator">=</span> cityRange<span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">"="</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 按等号分隔城市名和IP范围</span>
            <span class="token class-name">String</span> city <span class="token operator">=</span> parts<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
            <span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> ranges <span class="token operator">=</span> parts<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">","</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 按逗号分隔起始和结束IP</span>

            <span class="token keyword">long</span> start <span class="token operator">=</span> <span class="token function">ipToLong</span><span class="token punctuation">(</span>ranges<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 将起始IP转换为长整型数</span>
            <span class="token keyword">long</span> end <span class="token operator">=</span> <span class="token function">ipToLong</span><span class="token punctuation">(</span>ranges<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 将结束IP转换为长整型数</span>

            <span class="token comment">// 将城市和对应的IP范围添加到映射中</span>
            cityIpRanges<span class="token punctuation">.</span><span class="token function">putIfAbsent</span><span class="token punctuation">(</span>city<span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            cityIpRanges<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>city<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">IpRange</span><span class="token punctuation">(</span>start<span class="token punctuation">,</span> end<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token keyword">return</span> cityIpRanges<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// 将IP地址转换为长整型数的方法</span>
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">long</span> <span class="token function">ipToLong</span><span class="token punctuation">(</span><span class="token class-name">String</span> ip<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> octets <span class="token operator">=</span> ip<span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">"\\."</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 按点分隔IP地址</span>
        <span class="token keyword">long</span> result <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">String</span> octet <span class="token operator">:</span> octets<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            result <span class="token operator">=</span> result <span class="token operator">&lt;&lt;</span> <span class="token number">8</span><span class="token punctuation">;</span> <span class="token comment">// 每个八位数左移8位</span>
            result <span class="token operator">|=</span> <span class="token class-name">Integer</span><span class="token punctuation">.</span><span class="token function">parseInt</span><span class="token punctuation">(</span>octet<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 将当前八位数添加到结果中</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> result<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// 内部类，表示IP范围</span>
    <span class="token keyword">static</span> <span class="token keyword">class</span> <span class="token class-name">IpRange</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">long</span> start<span class="token punctuation">;</span> <span class="token comment">// 起始IP的长整型数</span>
        <span class="token keyword">long</span> end<span class="token punctuation">;</span> <span class="token comment">// 结束IP的长整型数</span>

        <span class="token comment">// 构造函数</span>
        <span class="token class-name">IpRange</span><span class="token punctuation">(</span><span class="token keyword">long</span> start<span class="token punctuation">,</span> <span class="token keyword">long</span> end<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>start <span class="token operator">=</span> start<span class="token punctuation">;</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>end <span class="token operator">=</span> end<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> 
<h2><a id="javaScript_272"></a>javaScript</h2> 
<pre><code class="prism language-js"><span class="token keyword">const</span> readline <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'readline'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 创建readline接口实例</span>
<span class="token keyword">const</span> rl <span class="token operator">=</span> readline<span class="token punctuation">.</span><span class="token function">createInterface</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
  <span class="token literal-property property">input</span><span class="token operator">:</span> process<span class="token punctuation">.</span>stdin<span class="token punctuation">,</span> <span class="token comment">// 设置标准输入</span>
  <span class="token literal-property property">output</span><span class="token operator">:</span> process<span class="token punctuation">.</span>stdout <span class="token comment">// 设置标准输出</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 将IP地址转换为长整型数的函数</span>
<span class="token keyword">function</span> <span class="token function">ipToLong</span><span class="token punctuation">(</span><span class="token parameter">ip</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
  <span class="token comment">// 使用split('.')将IP地址分割为四部分，然后使用reduce方法累加每部分</span>
  <span class="token keyword">return</span> ip<span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">'.'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">reduce</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">acc<span class="token punctuation">,</span> octet</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span>acc <span class="token operator">&lt;&lt;</span> <span class="token number">8</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token function">parseInt</span><span class="token punctuation">(</span>octet<span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">// 解析IP地址池的函数</span>
<span class="token keyword">function</span> <span class="token function">parseIpPool</span><span class="token punctuation">(</span><span class="token parameter">ipPool</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
  <span class="token keyword">const</span> cityIpRanges <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span><span class="token punctuation">}</span><span class="token punctuation">;</span> <span class="token comment">// 创建一个对象用于存储城市和对应的IP范围</span>
  ipPool<span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">';'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token parameter">cityRange</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">const</span> <span class="token punctuation">[</span>city<span class="token punctuation">,</span> range<span class="token punctuation">]</span> <span class="token operator">=</span> cityRange<span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">'='</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 分割字符串获取城市名和IP范围</span>
    <span class="token keyword">const</span> <span class="token punctuation">[</span>startIp<span class="token punctuation">,</span> endIp<span class="token punctuation">]</span> <span class="token operator">=</span> range<span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">','</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 分割字符串获取起始IP和结束IP</span>
    <span class="token keyword">const</span> start <span class="token operator">=</span> <span class="token function">ipToLong</span><span class="token punctuation">(</span>startIp<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 将起始IP转换为长整型数</span>
    <span class="token keyword">const</span> end <span class="token operator">=</span> <span class="token function">ipToLong</span><span class="token punctuation">(</span>endIp<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 将结束IP转换为长整型数</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>cityIpRanges<span class="token punctuation">[</span>city<span class="token punctuation">]</span><span class="token punctuation">)</span> cityIpRanges<span class="token punctuation">[</span>city<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">// 如果对象中不存在该城市，则初始化一个空数组</span>
    cityIpRanges<span class="token punctuation">[</span>city<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span> start<span class="token punctuation">,</span> end <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 将IP范围对象添加到对应城市的数组中</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> cityIpRanges<span class="token punctuation">;</span> <span class="token comment">// 返回解析后的城市IP范围对象</span>
<span class="token punctuation">}</span>

<span class="token comment">// 匹配城市的函数</span>
<span class="token keyword">function</span> <span class="token function">matchCities</span><span class="token punctuation">(</span><span class="token parameter">ipPool<span class="token punctuation">,</span> queryIPs</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
  <span class="token keyword">const</span> cityIpRanges <span class="token operator">=</span> <span class="token function">parseIpPool</span><span class="token punctuation">(</span>ipPool<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 调用parseIpPool函数解析IP池</span>
  <span class="token keyword">return</span> queryIPs<span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">','</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token parameter">ip</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">const</span> ipNum <span class="token operator">=</span> <span class="token function">ipToLong</span><span class="token punctuation">(</span>ip<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 将查询的IP地址转换为长整型数</span>
    <span class="token keyword">let</span> bestMatchCity <span class="token operator">=</span> <span class="token string">''</span><span class="token punctuation">;</span> <span class="token comment">// 初始化最佳匹配城市为空字符串</span>
    <span class="token keyword">let</span> smallestRange <span class="token operator">=</span> Number<span class="token punctuation">.</span><span class="token constant">MAX_SAFE_INTEGER</span><span class="token punctuation">;</span> <span class="token comment">// 初始化最小范围为最大安全整数</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">const</span> city <span class="token keyword">in</span> cityIpRanges<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span> <span class="token comment">// 遍历城市IP范围对象</span>
      cityIpRanges<span class="token punctuation">[</span>city<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token parameter">range</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>ipNum <span class="token operator">&gt;=</span> range<span class="token punctuation">.</span>start <span class="token operator">&amp;&amp;</span> ipNum <span class="token operator">&lt;=</span> range<span class="token punctuation">.</span>end<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span> <span class="token comment">// 判断IP是否在当前范围内</span>
          <span class="token keyword">const</span> rangeSize <span class="token operator">=</span> range<span class="token punctuation">.</span>end <span class="token operator">-</span> range<span class="token punctuation">.</span>start<span class="token punctuation">;</span> <span class="token comment">// 计算当前范围的大小</span>
          <span class="token keyword">if</span> <span class="token punctuation">(</span>rangeSize <span class="token operator">&lt;</span> smallestRange<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span> <span class="token comment">// 如果当前范围小于已知的最小范围</span>
            bestMatchCity <span class="token operator">=</span> city<span class="token punctuation">;</span> <span class="token comment">// 更新最佳匹配城市</span>
            smallestRange <span class="token operator">=</span> rangeSize<span class="token punctuation">;</span> <span class="token comment">// 更新最小范围</span>
          <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> bestMatchCity<span class="token punctuation">;</span> <span class="token comment">// 返回最佳匹配城市</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token string">','</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 将匹配结果数组转换为字符串，并用逗号分隔</span>
<span class="token punctuation">}</span>

<span class="token comment">// 读取输入</span>
<span class="token keyword">let</span> lines <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">// 初始化一个数组用于存储输入的每一行</span>
rl<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'line'</span><span class="token punctuation">,</span> <span class="token parameter">line</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
  lines<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>line<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 将每一行输入添加到数组中</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'close'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
  <span class="token comment">// 当输入结束时，调用matchCities函数并输出匹配的城市列表</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token function">matchCities</span><span class="token punctuation">(</span>lines<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> lines<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<h2><a id="Python_337"></a>Python</h2> 
<pre><code class="prism language-python"><span class="token keyword">import</span> sys

<span class="token comment"># 将IP地址转换为长整型数的函数</span>
<span class="token keyword">def</span> <span class="token function">ip_to_long</span><span class="token punctuation">(</span>ip<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token comment"># 分割IP地址为四个八位字节，并转换为整型</span>
    octets <span class="token operator">=</span> <span class="token builtin">map</span><span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">,</span> ip<span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">'.'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token comment"># 将四个八位字节转换为一个长整型数</span>
    <span class="token keyword">return</span> <span class="token builtin">sum</span><span class="token punctuation">(</span>octet <span class="token operator">&lt;&lt;</span> <span class="token punctuation">(</span><span class="token number">8</span> <span class="token operator">*</span> <span class="token punctuation">(</span><span class="token number">3</span> <span class="token operator">-</span> index<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">for</span> index<span class="token punctuation">,</span> octet <span class="token keyword">in</span> <span class="token builtin">enumerate</span><span class="token punctuation">(</span>octets<span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token comment"># 解析IP地址池的函数</span>
<span class="token keyword">def</span> <span class="token function">parse_ip_pool</span><span class="token punctuation">(</span>ip_pool<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token comment"># 创建一个字典，用于存储城市及其对应的IP范围</span>
    city_ip_ranges <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span><span class="token punctuation">}</span>
    <span class="token comment"># 分割IP池字符串，获取每个城市及其IP范围</span>
    <span class="token keyword">for</span> city_range <span class="token keyword">in</span> ip_pool<span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">';'</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token comment"># 分割得到城市名和IP范围</span>
        city<span class="token punctuation">,</span> ranges <span class="token operator">=</span> city_range<span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">'='</span><span class="token punctuation">)</span>
        <span class="token comment"># 分割得到起始IP和结束IP</span>
        start_ip<span class="token punctuation">,</span> end_ip <span class="token operator">=</span> ranges<span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">','</span><span class="token punctuation">)</span>
        <span class="token comment"># 将起始IP和结束IP转换为长整型数</span>
        start <span class="token operator">=</span> ip_to_long<span class="token punctuation">(</span>start_ip<span class="token punctuation">)</span>
        end <span class="token operator">=</span> ip_to_long<span class="token punctuation">(</span>end_ip<span class="token punctuation">)</span>
        <span class="token comment"># 如果城市不在字典中，则添加城市并初始化IP范围列表</span>
        <span class="token keyword">if</span> city <span class="token keyword">not</span> <span class="token keyword">in</span> city_ip_ranges<span class="token punctuation">:</span>
            city_ip_ranges<span class="token punctuation">[</span>city<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
        <span class="token comment"># 将IP范围添加到城市的IP范围列表中</span>
        city_ip_ranges<span class="token punctuation">[</span>city<span class="token punctuation">]</span><span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token punctuation">(</span>start<span class="token punctuation">,</span> end<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token comment"># 返回城市及其IP范围的字典</span>
    <span class="token keyword">return</span> city_ip_ranges

<span class="token comment"># 匹配城市的函数</span>
<span class="token keyword">def</span> <span class="token function">match_cities</span><span class="token punctuation">(</span>ip_pool<span class="token punctuation">,</span> query_ips<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token comment"># 解析IP池，获取城市及其IP范围的字典</span>
    city_ip_ranges <span class="token operator">=</span> parse_ip_pool<span class="token punctuation">(</span>ip_pool<span class="token punctuation">)</span>
    <span class="token comment"># 创建一个列表，用于存储查询结果</span>
    result <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
    <span class="token comment"># 分割查询IP列表，逐个处理</span>
    <span class="token keyword">for</span> ip <span class="token keyword">in</span> query_ips<span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">','</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token comment"># 将IP地址转换为长整型数</span>
        ip_num <span class="token operator">=</span> ip_to_long<span class="token punctuation">(</span>ip<span class="token punctuation">)</span>
        <span class="token comment"># 初始化最佳匹配城市为空字符串</span>
        best_match_city <span class="token operator">=</span> <span class="token string">''</span>
        <span class="token comment"># 初始化最小范围为系统最大整数</span>
        smallest_range <span class="token operator">=</span> sys<span class="token punctuation">.</span>maxsize
        <span class="token comment"># 遍历所有城市及其IP范围</span>
        <span class="token keyword">for</span> city<span class="token punctuation">,</span> ranges <span class="token keyword">in</span> city_ip_ranges<span class="token punctuation">.</span>items<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            <span class="token comment"># 遍历城市的IP范围</span>
            <span class="token keyword">for</span> start<span class="token punctuation">,</span> end <span class="token keyword">in</span> ranges<span class="token punctuation">:</span>
                <span class="token comment"># 判断当前IP是否在范围内</span>
                <span class="token keyword">if</span> start <span class="token operator">&lt;=</span> ip_num <span class="token operator">&lt;=</span> end<span class="token punctuation">:</span>
                    <span class="token comment"># 计算当前范围的大小</span>
                    range_size <span class="token operator">=</span> end <span class="token operator">-</span> start
                    <span class="token comment"># 如果当前范围小于已知的最小范围，则更新最佳匹配城市和最小范围</span>
                    <span class="token keyword">if</span> range_size <span class="token operator">&lt;</span> smallest_range<span class="token punctuation">:</span>
                        best_match_city <span class="token operator">=</span> city
                        smallest_range <span class="token operator">=</span> range_size
        <span class="token comment"># 将最佳匹配城市添加到结果列表中</span>
        result<span class="token punctuation">.</span>append<span class="token punctuation">(</span>best_match_city<span class="token punctuation">)</span>
    <span class="token comment"># 将结果列表转换为字符串，并用逗号分隔</span>
    <span class="token keyword">return</span> <span class="token string">','</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span>result<span class="token punctuation">)</span>

<span class="token comment"># 读取输入</span>
ip_pool <span class="token operator">=</span> <span class="token builtin">input</span><span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment"># 读取IP地址池</span>
query_ips <span class="token operator">=</span> <span class="token builtin">input</span><span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment"># 读取查询IP列表</span>

<span class="token comment"># 输出匹配的城市列表</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>match_cities<span class="token punctuation">(</span>ip_pool<span class="token punctuation">,</span> query_ips<span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre> 
<h2><a id="C_409"></a>C语言</h2> 
<pre><code class="prism language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdlib.h&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;string.h&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;limits.h&gt;</span> <span class="token comment">// 为了使用LONG_MAX</span></span>

<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">CITY_NAME_LENGTH</span> <span class="token expression"><span class="token number">100</span></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">MAX_RANGES</span> <span class="token expression"><span class="token number">1024</span></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">MAX_IP_LEN</span> <span class="token expression"><span class="token number">15</span></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">MAX_LINE_LEN</span> <span class="token expression"><span class="token number">10000</span></span></span>

<span class="token comment">// 声明ipToLong函数</span>
<span class="token keyword">long</span> <span class="token function">ipToLong</span><span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span>ip<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 定义IP范围结构体</span>
<span class="token keyword">typedef</span> <span class="token keyword">struct</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">char</span> city<span class="token punctuation">[</span>CITY_NAME_LENGTH<span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">long</span> startIpDec<span class="token punctuation">;</span>
    <span class="token keyword">long</span> endIpDec<span class="token punctuation">;</span>
    <span class="token keyword">long</span> ipLen<span class="token punctuation">;</span>
<span class="token punctuation">}</span> Range<span class="token punctuation">;</span>

<span class="token comment">// 创建新的Range实例</span>
Range <span class="token function">new_Range</span><span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">char</span><span class="token operator">*</span> city<span class="token punctuation">,</span> <span class="token keyword">const</span> <span class="token keyword">char</span><span class="token operator">*</span> startIpStr<span class="token punctuation">,</span> <span class="token keyword">const</span> <span class="token keyword">char</span><span class="token operator">*</span> endIpStr<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    Range range<span class="token punctuation">;</span>
    <span class="token function">strncpy</span><span class="token punctuation">(</span>range<span class="token punctuation">.</span>city<span class="token punctuation">,</span> city<span class="token punctuation">,</span> CITY_NAME_LENGTH<span class="token punctuation">)</span><span class="token punctuation">;</span>
    range<span class="token punctuation">.</span>startIpDec <span class="token operator">=</span> <span class="token function">ipToLong</span><span class="token punctuation">(</span>startIpStr<span class="token punctuation">)</span><span class="token punctuation">;</span>
    range<span class="token punctuation">.</span>endIpDec <span class="token operator">=</span> <span class="token function">ipToLong</span><span class="token punctuation">(</span>endIpStr<span class="token punctuation">)</span><span class="token punctuation">;</span>
    range<span class="token punctuation">.</span>ipLen <span class="token operator">=</span> range<span class="token punctuation">.</span>endIpDec <span class="token operator">-</span> range<span class="token punctuation">.</span>startIpDec<span class="token punctuation">;</span>
    <span class="token keyword">return</span> range<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">// 将IP地址转换为长整数的函数</span>
<span class="token keyword">long</span> <span class="token function">ipToLong</span><span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span>ip<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">long</span> result <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token keyword">int</span> part<span class="token punctuation">;</span>
    <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token operator">*</span>ip<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        part <span class="token operator">=</span> <span class="token function">strtol</span><span class="token punctuation">(</span>ip<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token keyword">char</span> <span class="token operator">*</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token operator">&amp;</span>ip<span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        result <span class="token operator">=</span> <span class="token punctuation">(</span>result <span class="token operator">&lt;&lt;</span> <span class="token number">8</span><span class="token punctuation">)</span> <span class="token operator">+</span> part<span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">*</span>ip <span class="token operator">==</span> <span class="token char">'.'</span><span class="token punctuation">)</span> ip<span class="token operator">++</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> result<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">// 匹配查询IP并返回对应城市的函数</span>
<span class="token keyword">void</span> <span class="token function">matchCities</span><span class="token punctuation">(</span>Range ranges<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token keyword">int</span> rangeSize<span class="token punctuation">,</span> <span class="token keyword">const</span> <span class="token keyword">char</span><span class="token operator">*</span> queryIPs<span class="token punctuation">,</span> <span class="token keyword">char</span><span class="token operator">*</span> result<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">char</span> queryIPsCopy<span class="token punctuation">[</span>MAX_LINE_LEN<span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token function">strncpy</span><span class="token punctuation">(</span>queryIPsCopy<span class="token punctuation">,</span> queryIPs<span class="token punctuation">,</span> MAX_LINE_LEN<span class="token punctuation">)</span><span class="token punctuation">;</span>
    queryIPsCopy<span class="token punctuation">[</span>MAX_LINE_LEN <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token char">'\0'</span><span class="token punctuation">;</span>

    <span class="token keyword">char</span><span class="token operator">*</span> token <span class="token operator">=</span> <span class="token function">strtok</span><span class="token punctuation">(</span>queryIPsCopy<span class="token punctuation">,</span> <span class="token string">","</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">char</span> bestMatchCity<span class="token punctuation">[</span>CITY_NAME_LENGTH<span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">while</span> <span class="token punctuation">(</span>token<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">long</span> ipNum <span class="token operator">=</span> <span class="token function">ipToLong</span><span class="token punctuation">(</span>token<span class="token punctuation">)</span><span class="token punctuation">;</span>
        bestMatchCity<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token char">'\0'</span><span class="token punctuation">;</span> <span class="token comment">// 初始化最佳匹配城市为空字符串</span>
        <span class="token keyword">long</span> smallestRange <span class="token operator">=</span> LONG_MAX<span class="token punctuation">;</span>

        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> rangeSize<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>ipNum <span class="token operator">&gt;=</span> ranges<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>startIpDec <span class="token operator">&amp;&amp;</span> ipNum <span class="token operator">&lt;=</span> ranges<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>endIpDec<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                <span class="token keyword">long</span> rangeSize <span class="token operator">=</span> ranges<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>ipLen<span class="token punctuation">;</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span>rangeSize <span class="token operator">&lt;</span> smallestRange<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                    <span class="token function">strncpy</span><span class="token punctuation">(</span>bestMatchCity<span class="token punctuation">,</span> ranges<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>city<span class="token punctuation">,</span> CITY_NAME_LENGTH<span class="token punctuation">)</span><span class="token punctuation">;</span>
                    smallestRange <span class="token operator">=</span> rangeSize<span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>

        <span class="token keyword">if</span> <span class="token punctuation">(</span>bestMatchCity<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">!=</span> <span class="token char">'\0'</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token function">strcat</span><span class="token punctuation">(</span>result<span class="token punctuation">,</span> bestMatchCity<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token function">strcat</span><span class="token punctuation">(</span>result<span class="token punctuation">,</span> <span class="token string">","</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        token <span class="token operator">=</span> <span class="token function">strtok</span><span class="token punctuation">(</span><span class="token constant">NULL</span><span class="token punctuation">,</span> <span class="token string">","</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// 移除结果字符串末尾的逗号</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">strlen</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        result<span class="token punctuation">[</span><span class="token function">strlen</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token char">'\0'</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">// main函数：读取输入，解析IP池和查询IP，输出匹配的城市列表</span>
<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">char</span> ipPool<span class="token punctuation">[</span>MAX_LINE_LEN<span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">char</span> queryIPs<span class="token punctuation">[</span>MAX_LINE_LEN<span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">char</span> result<span class="token punctuation">[</span>MAX_LINE_LEN<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">;</span>

    <span class="token comment">// 读取IP地址池和查询IP列表</span>
    <span class="token function">fgets</span><span class="token punctuation">(</span>ipPool<span class="token punctuation">,</span> MAX_LINE_LEN<span class="token punctuation">,</span> <span class="token constant">stdin</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">fgets</span><span class="token punctuation">(</span>queryIPs<span class="token punctuation">,</span> MAX_LINE_LEN<span class="token punctuation">,</span> <span class="token constant">stdin</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    ipPool<span class="token punctuation">[</span><span class="token function">strcspn</span><span class="token punctuation">(</span>ipPool<span class="token punctuation">,</span> <span class="token string">"\n"</span><span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token char">'\0'</span><span class="token punctuation">;</span>
    queryIPs<span class="token punctuation">[</span><span class="token function">strcspn</span><span class="token punctuation">(</span>queryIPs<span class="token punctuation">,</span> <span class="token string">"\n"</span><span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token char">'\0'</span><span class="token punctuation">;</span>

    <span class="token comment">// 解析IP地址池</span>
    Range ranges<span class="token punctuation">[</span>MAX_RANGES<span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">int</span> ranges_size <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token keyword">char</span><span class="token operator">*</span> token1 <span class="token operator">=</span> <span class="token function">strtok</span><span class="token punctuation">(</span>ipPool<span class="token punctuation">,</span> <span class="token string">";"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">while</span> <span class="token punctuation">(</span>token1<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">char</span> city<span class="token punctuation">[</span>CITY_NAME_LENGTH<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span><span class="token char">'\0'</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
        <span class="token keyword">char</span> startIpStr<span class="token punctuation">[</span>MAX_IP_LEN<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span><span class="token char">'\0'</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
        <span class="token keyword">char</span> endIpStr<span class="token punctuation">[</span>MAX_IP_LEN<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span><span class="token char">'\0'</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
        
        <span class="token function">sscanf</span><span class="token punctuation">(</span>token1<span class="token punctuation">,</span> <span class="token string">"%[^=]=%[^,],%[^,]"</span><span class="token punctuation">,</span> city<span class="token punctuation">,</span> startIpStr<span class="token punctuation">,</span> endIpStr<span class="token punctuation">)</span><span class="token punctuation">;</span>
        ranges<span class="token punctuation">[</span>ranges_size<span class="token operator">++</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">new_Range</span><span class="token punctuation">(</span>city<span class="token punctuation">,</span> startIpStr<span class="token punctuation">,</span> endIpStr<span class="token punctuation">)</span><span class="token punctuation">;</span>
        
        token1 <span class="token operator">=</span> <span class="token function">strtok</span><span class="token punctuation">(</span><span class="token constant">NULL</span><span class="token punctuation">,</span> <span class="token string">";"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// 匹配查询IP并输出结果</span>
    <span class="token function">matchCities</span><span class="token punctuation">(</span>ranges<span class="token punctuation">,</span> ranges_size<span class="token punctuation">,</span> queryIPs<span class="token punctuation">,</span> result<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%s\n"</span><span class="token punctuation">,</span> result<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<h2><a id="_530"></a>完整用例</h2> 
<h3><a id="1_532"></a>用例1</h3> 
<pre><code class="prism language-input1">City1=1.1.1.1,1.1.1.10;City2=1.1.1.5,1.1.1.15;City3=1.1.1.20,1.1.1.25
1.1.1.7,1.1.1.22
</code></pre> 
<h3><a id="2_539"></a>用例2</h3> 
<pre><code class="prism language-input2">City1=10.0.0.1,10.0.0.10;City2=10.0.0.5,10.0.0.15;City3=10.0.0.20,10.0.0.25;City4=10.0.0.1,10.0.0.25
10.0.0.2,10.0.0.21
</code></pre> 
<h3><a id="3_546"></a>用例3</h3> 
<pre><code class="prism language-input3">City1=1.1.1.1,9.9.9.9;City2=2.2.2.2,8.8.8.8;City3=3.3.3.3,7.7.7.7;City4=4.4.4.4,6.6.6.6;City6=6.6.6.6,4.4.4.4;City7=7.7.7.7,3.3.3.3;City8=8.8.8.8,2.2.2.2;City9=9.9.9.9,1.1.1.1
7.2.6.10,7.8.2.6,5.7.3.10,10.3.2.6,3.9.7.3
</code></pre> 
<h3><a id="4_553"></a>用例4</h3> 
<pre><code class="prism language-input4">City1=17.17.17.1,17.17.17.10;City2=18.18.18.1,18.18.18.10
19.19.19.1,20.20.20.1
</code></pre> 
<h3><a id="5_560"></a>用例5</h3> 
<pre><code class="prism language-input5">City1=16.16.16.1,16.16.16.200;City2=16.16.16.100,16.16.16.110
16.16.16.105
</code></pre> 
<h3><a id="6_567"></a>用例6</h3> 
<pre><code class="prism language-input6">City1=15.15.15.1,15.15.15.50;City2=15.15.15.50,15.15.15.100
15.15.15.50
</code></pre> 
<h3><a id="7_574"></a>用例7</h3> 
<pre><code class="prism language-input7">City1=14.14.14.1,14.14.14.100;City2=14.14.14.50,14.14.14.60;City3=14.14.14.60,14.14.14.70
14.14.14.60
</code></pre> 
<h3><a id="8_581"></a>用例8</h3> 
<pre><code class="prism language-input8">City1=11.11.11.1,11.11.11.10;City2=12.12.12.1,12.12.12.10
11.11.11.5,12.12.12.5,13.13.13.5
</code></pre> 
<h3><a id="9_588"></a>用例9</h3> 
<pre><code class="prism language-input9">City1=7.7.7.1,7.7.7.100;City2=7.7.7.10,7.7.7.90;City3=7.7.7.20,7.7.7.80
7.7.7.25,7.7.7.85
</code></pre> 
<h3><a id="10_595"></a>用例10</h3> 
<pre><code class="prism language-input10">city_1=1.1.1.1,3.3.3.100;city_2=2.2.2.2,3.3.3.200
2.3.4.5,5.4.3.2,5.4.4.5
</code></pre> 
<p></p> 
<div class="toc"> 
 <h4>文章目录</h4> 
 <ul><li><a href="#_2" rel="nofollow">题目描述</a></li><li><a href="#_28" rel="nofollow">输入描述</a></li><li><a href="#_37" rel="nofollow">输出描述</a></li><li><a href="#_49" rel="nofollow">解题思路</a></li><li><a href="#C_70" rel="nofollow">C++</a></li><li><a href="#Java_172" rel="nofollow">Java</a></li><li><a href="#javaScript_272" rel="nofollow">javaScript</a></li><li><a href="#Python_337" rel="nofollow">Python</a></li><li><a href="#C_409" rel="nofollow">C语言</a></li><li><a href="#_530" rel="nofollow">完整用例</a></li><li><ul><li><a href="#1_532" rel="nofollow">用例1</a></li><li><a href="#2_539" rel="nofollow">用例2</a></li><li><a href="#3_546" rel="nofollow">用例3</a></li><li><a href="#4_553" rel="nofollow">用例4</a></li><li><a href="#5_560" rel="nofollow">用例5</a></li><li><a href="#6_567" rel="nofollow">用例6</a></li><li><a href="#7_574" rel="nofollow">用例7</a></li><li><a href="#8_581" rel="nofollow">用例8</a></li><li><a href="#9_588" rel="nofollow">用例9</a></li><li><a href="#10_595" rel="nofollow">用例10</a></li></ul> 
 </li></ul> 
</div> 
<p></p> 
<p><img src="https://i-blog.csdnimg.cn/blog_migrate/da46f0f2c8e433613f650051862accc4.png" alt="fengmian"></p>
                </div>
</body>
</html>
